---
# Preámbulo con paquetes y definiciones básicas
# Se incluyen los comandos mínimos de LaTeX
#title: Equipo4
author:
 - Andrés Arredondo (email_1@gmail.com)
 - Adriana Haydé Contreras Peruyero (haydeeperuyero@gmail.com)
 - David Alberto García Estrada (@gmail.com)
header-includes:
  - \usepackage{mathtools}
  - \usepackage{amsthm}
  - \usepackage{amssymb}
  - \usepackage{eufrak}
  - \usepackage{mathrsfs}
  - \usepackage{color}
  - \usepackage[spanish]{babel}
  - \usepackage{fancyhdr}
  - \usepackage{array}
  - \usepackage{subfigure} %para incluir mas de una figura en un solo espacio
  - \usepackage{graphicx}
  - \allowdisplaybreaks #% para permitir rompimiento de ecuaciones en p\'aginas distintas
    # ver http://tex.stackexchange.com/questions/51682/is-it-possible-to-pagebreak-aligned-equations
    # para m\'as detalles
  #- \numberwithin{equation}{section} # Para numerar ecuaciones por secciones cuando están numeradas
  # - \decimalpoint
  #- \usepackage{caption}
  - \usepackage{float}
  #- \usepackage[font=small,labelfont=bf]{caption}
  # para usar kableExtra se requieren los siguientes paquetes
  # ver
  # https://haozhu233.github.io/kableExtra/awesome_table_in_pdf.pdf
  # para más detalles
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  # Definir ambientes de Teorema
  - \newtheorem{teorema}{Teorema}
  - \newtheorem{lema}[teorema]{Lema}
  - \newtheorem{corolario}[teorema]{Corolario}
  - \newtheorem{proposicion}[teorema]{Proposici\'on}
  - \newtheorem{conjetura}[teorema]{Conjetura}
  - \newtheorem{definicion}{Definici\'on}
  - \newtheorem{ejemplo}[teorema]{Ejemplo}
  - \newtheorem{nota}{Nota}
  
output: 
  pdf_document:
    toc_depth: 2
    number_sections: true
    df_print: kable
    highlight: tango
---

\newcommand{\cb}{\color{blue}}
\newcommand{\cg}{\color{green}}
\newcommand{\cvi}{\color{violet}}


<!-- El siguiente código sirve para poner el logo del encabezado. -->
<!-- \pagestyle{fancy} -->
<!-- \fancyhf{} -->

<!-- \rhead{\begin{picture}(0,0)  -->
<!-- \put(-40,-40) %mover de posición la imagen -->
<!-- {\includegraphics[width=15mm] -->
<!-- {images/ccm-2}}  -->
<!-- \end{picture}} -->

<!-- \renewcommand{\headrulewidth}{0pt} -->
<!-- \rfoot[\thepage]{\vspace{-0.5cm} \thepage} -->


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

```{r include = FALSE, echo = FALSE}
##  LIBRERÍAS
# Aquí vamos a incluir las librerías que necesitemos
# En donde se pongan pedazos de código, únicamente se comentará
# Es BUENA PRÁCTICA poner las librerías al principio, por ello las ponemos aquí
# Primero deben asegurarse de tener instalados todos los paquetes
#install.packages("kableExtra")
# library(library_name)
#library(knitr)
#library(readr)
library(ggplot2)
library(tidyverse)
#library(kableExtra)
library(phyloseq)
#library(plyr)
#library(dplyr)
#library(factoextra)
# tydiverse incluye ggplot2, readr, dplyr, etc 
```

<!-- AQUÍ INICIA LA PÁGINA DE TÍTULO
  Indicaciones:
          El nombre de los autores aparece al principio
-->

\title{ {\sc Centro de Ciencias Matemáticas}\\
\vspace{1cm}{\sc CINVESTAV }\\ 
\vspace{1cm}{\sc ENES}
   \vspace{1.5cm} {Análisis exploratorio de datos de microbiomas} \\
       \vspace{1.5cm} {Capítulo 7}\\[2cm]
       }
  
\date{\vspace{5.5cm} Morelia\\
      \vspace{1cm} Septiembre de 2022}

 \maketitle
 

\thispagestyle{fancy}
\newpage

<!-- FIN DE LA PÁGINA DE  TÍTULO-->

<!-- INICIO ÍNDICE -->

\tableofcontents
\newpage
<!-- FIN INDICE -->



<!-- INICIO DOCUMENTO -->


# Datos de Ratones y Humanos

Las bases de datos que se ocuparon son dos:

  - Vdr: es una base de datos de ratones. Contiene datos de microbiomas intestinales y fueron recolectados de heces y muestras de heces cecales. Las que se usan en este capítulo son de heces.
  - Troat.otu.tab: estos datos son de fumadores y se encuentran en el paquete `GUniFrac`. Estos datos se usarán para explorar el árbol filogenético.
  
  
# Análisis exploratorio con resumen gráfico

En este capítulo se exploran diferentes gráficos usuales: riquesa, barras de abundancia, mapas de calor, redes y árbol filogenético.

## Gráficos de riqueza

En el capítulo anterior se exploró la diversidad alfa, en este capítulo vamos a explorar un gráfico relacionado a esto. Para esto, se usa la función `plot_richness()` del paquete `phyloseq`. Generalmente, la riqueza se refiere a un gráfico del número toal de especies, taxones u OTUs en un ambiente, pero está función también nos da otras figuras relacionadas a otras diversidades. 

Lo primero que debemos hacer es instalar el paquete y leer los datos.

```{r}
#Para instalar el paquete, usamos Bioconductor

#if (!require("BiocManager", quietly = TRUE))
 # install.packages("BiocManager")

#BiocManager::install("phyloseq")
```

En la carpeta `data` se encuentra la base de datos a usar `VdrFecalGenusCounts.csv`.

```{r}
setwd("D:/Users/hayde/Documents/R_sites/Equipo4")
```

```{r}
#library(phyloseq)
#library(ggplot2)
abund_table=read.csv("./data/VdrFecalGenusCounts.csv",row.names=1,check.names=FALSE)
abund_table<-t(abund_table)
```





